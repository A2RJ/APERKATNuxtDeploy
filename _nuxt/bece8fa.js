(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{567:function(t,e,n){"use strict";n.r(e);n(5),n(4),n(2),n(6),n(3),n(7);var r=n(0),o=n(23),l=(n(69),n(1),n(47),n(50),n(491),n(240),n(46));function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.store,e.next=3,Promise.all([n.dispatch("rkat/getrkat")]);case 3:return e.abrupt("return");case 4:case"end":return e.stop()}}),e)})))()},data:function(){return{key:"id_rkat",actions:[{name:"Tambah",type:"link",link:"rkat/add",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Import",type:"func",func:"importRKAT",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Reset",type:"func",func:"deleteAll",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Select All",type:"func",func:"selectAll",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Clear Selected",type:"func",func:"clearSelected",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Print",type:"func",func:"print",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Print Selected",type:"func",func:"printSelected",color:"btn btn-sm btn-outline-primary mt-1 ml-2"},{name:"Delete Selected",type:"func",func:"deleteSelected",color:"btn btn-sm btn-outline-primary mt-1 ml-2"}],fields:[{key:"fullname",label:"Pelaksana"},{key:"kode_rkat",label:"Kode RKAT "},"mulai_program",{key:"mulai_program",label:"Mulai Kegiatan"},{key:"selesai_program",label:"Selesai Kegiatan"},{key:"created_at",label:"Waktu Pengajuan"},{key:"total_anggaran",label:"Total Anggaran"},{key:"anggaran_digunakan",label:"Anggaran dicairkan"},"total_anggaran","actions"],items:[],importRkat:!1,file:"",data:null,id_user:null,error:null,file1:null,pesan:!1,selected:[],options:[],uploadPercentage:0}},computed:d({},Object(l.d)("rkat",{rkat:function(t){return t.rkat}})),mounted:function(){this.items=this.rkat},methods:d(d(d({},Object(l.c)(["SET_IS_AUTH","SET_USER_DATA"])),Object(l.b)("rkat",["getrkat","deleterkat","getUser"])),{},{destroyrkat:function(t){var e=this;this.$swal({title:"Warning!",text:"Yakin menghapus RKAT?",icon:"warning",width:300,showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"OK"}).then((function(n){n.isConfirmed&&e.deleterkat(t).then((function(){e.$swal({width:300,icon:"success",title:"Congrats!",text:"RKAT data was deleted successfully"}),e.reload()})).catch((function(){e.$swal({width:300,icon:"error",title:"Oops...",text:"Please check your server or internet connection"})}))}))},deleteAll:function(){var t=this;this.$swal({title:"Warning!",text:"Yakin menghapus semua RKAT?",icon:"warning",width:300,showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isConfirmed){e.next=3;break}return e.next=3,t.$axios.get("/rkat/destroy").then((function(){t.$swal({width:300,icon:"success",title:"Congrats!",text:"RKAT telah dihapus"}),t.reload()})).catch((function(){t.$swal({width:300,icon:"error",title:"Oops...",text:"Cek server atau koneksi anda"})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},print:function(t){var e=this;this.$axios.post("/rkat/printRows",t,{responseType:"blob"}).then((function(t){var n=window.URL.createObjectURL(new Blob([t.data])),link=document.createElement("a");link.href=n,link.setAttribute("download","RKAT.pdf"),document.body.appendChild(link),link.click(),e.$swal({width:300,icon:"success",title:"Congrats!",text:"RKAT telah dihapus"})}))},deleteRows:function(t){var e=this;this.$swal({title:"Warning!",text:"Yakin menghapus RKAT terpilih?",icon:"warning",width:300,showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"OK"}).then((function(n){n.isConfirmed&&e.$axios.post("/rkat/deleteRows",t).then((function(){e.$swal({width:300,icon:"success",title:"Congrats!",text:"RKAT data was deleted successfully"}),e.reload()})).catch((function(){e.$swal({width:300,icon:"error",title:"Oops...",text:"Please check your server or internet connection"})}))}))},reload:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$nuxt.refresh();case 2:return e.next=4,t.$refs.table.reload(t.rkat);case 4:case"end":return e.stop()}}),e)})))()},importRKAT:function(){var t=this;this.importRkat=!0,this.$axios.get("/user/rkatUser").then((function(e){t.options=e.data.data})).catch((function(t){}))},handleFileUpload:function(){this.file1=this.$refs.file.files[0]},downloadFile:function(){window.open("https://aperkat.uts.ac.id/api/public/draftfile/RKATemplate.xlsx")},resetFile:function(){this.file1=null,this.data=null,this.selected=[]},submitFile:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.selected){e.next=8;break}return t.pesan=!1,(n=new FormData).append("file",t.file1),e.next=6,t.$axios.post("/rkat/uploadRKAT",n,{headers:{"Content-Type":"multipart/form-data;"},onUploadProgress:function(t){this.uploadPercentage=Math.round(100*t.loaded/t.total)}.bind(t)}).then((function(e){t.data=e.data,t.error=null})).catch((function(e){t.data=null,t.error="Pastikan format file benar!"}));case 6:e.next=9;break;case 8:t.pesan=!0;case 9:case"end":return e.stop()}}),e)})))()},get:function(t){t&&(this.selected=t.label,this.id_user=t.code)},postImport:function(){var t=this;this.$axios.post("/rkat/postImport/".concat(this.id_user),this.data).then((function(e){t.data=null,t.importRkat=!1,t.reload()})).catch((function(t){}))}})},f=m,_=n(44),component=Object(_.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-12 col-lg-12"},[n("div",{staticClass:"card shadow mb-4"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.importRkat,expression:"importRkat"}],staticClass:"mb-3 mx-auto"},[n("b-alert",{attrs:{variant:"primary",dismissible:""},model:{value:t.importRkat,callback:function(e){t.importRkat=e},expression:"importRkat"}},[n("div",{staticClass:"container"},[n("div",{},[n("b-form-group",{attrs:{"label-cols":"4","label-cols-lg":"2","label-size":"sm",label:"Pelaksana","label-for":"id_user"}},[n("v-select",{attrs:{options:t.options,value:t.selected},on:{input:t.get},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),t._v(" "),t.pesan?n("b-form-text",{attrs:{id:"id_user"}},[n("i",{staticClass:"text-danger"},[t._v("Pelaksana is required")])]):t._e()],1),t._v(" "),n("b-form-file",{ref:"file",attrs:{size:"sm",state:Boolean(t.file1),placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here...",accept:".xls, .xlsx"},on:{change:function(e){return t.handleFileUpload()}},model:{value:t.file1,callback:function(e){t.file1=e},expression:"file1"}}),t._v(" "),n("b-progress-bar",{key:"info",staticClass:"my-1",attrs:{value:t.uploadPercentage,max:100,variant:"info","show-progress":"",animated:""}}),t._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-primary mt-1 ml-1",on:{click:function(e){return t.submitFile()}}},[t._v("\n                  Import\n                ")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-danger mt-1 ml-1",on:{click:function(e){return t.resetFile()}}},[t._v("\n                  Reset\n                ")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-info mt-1 ml-1",on:{click:function(e){return t.downloadFile()}}},[t._v("\n                  Download template\n                ")])],1),t._v(" "),t.data?n("table",{staticClass:"mt-4 table table-responsive",staticStyle:{width:"100%","border-collapse":"collapse",border:"1px solid #112031"}},[n("tr",[n("th",[t._v("#")]),t._v(" "),n("th",[t._v("Kode RKAT")]),t._v(" "),n("th",[t._v("Program Kerja")]),t._v(" "),n("th",[t._v("Deskripsi")]),t._v(" "),n("th",[t._v("Mulai Program")]),t._v(" "),n("th",[t._v("Selesai Program")]),t._v(" "),n("th",[t._v("Tempat")]),t._v(" "),n("th",[t._v("Anggaran")])]),t._v(" "),t._l(t.data.data,(function(e){return n("tr",{key:e.no},[n("td",[t._v(t._s(e.no))]),t._v(" "),n("td",[t._v(t._s(e.kode_rkat))]),t._v(" "),n("td",[t._v(t._s(e.program_kerja))]),t._v(" "),n("td",[t._v(t._s(e.deskripsi))]),t._v(" "),n("td",[t._v(t._s(e.mulai_program))]),t._v(" "),n("td",[t._v(t._s(e.selesai_program))]),t._v(" "),n("td",[t._v(t._s(e.tempat))]),t._v(" "),n("td",[t._v("RP. "+t._s(t._f("currency")(e.total_anggaran)))])])}))],2):t._e(),t._v(" "),t.data&&t.data.data&&0==t.data.data.length?n("div",{staticClass:"alert alert-danger my-3 text-center mx-auto",attrs:{role:"alert"}},[t._v("\n                Data sudah terimport!\n              ")]):t._e(),t._v(" "),t.data?n("div",{staticClass:"mt-2"},[n("b-button",{attrs:{variant:"outline-info btn-sm mt-1"},on:{click:t.postImport}},[t._v("Simpan RKAT")])],1):t._e(),t._v(" "),t.error?n("div",{staticClass:"alert alert-danger my-3 text-center mx-auto",attrs:{role:"alert"}},[t._v("\n                "+t._s(t.error)+"\n              ")]):t._e()])])],1)]),t._v(" "),n("div",{staticClass:"card-body"},[n("custom-table-RKAT",{ref:"table",attrs:{items:t.items,fields:t.fields,html:t.key,actions:t.actions},scopedSlots:t._u([{key:"fullname",fn:function(data){return[t._v("\n            "+t._s(t._f("capitalize")(data.value))+"\n          ")]}},{key:"total_anggaran",fn:function(data){return[t._v("\n            RP. "+t._s(t._f("currency")(data.value))+"\n          ")]}},{key:"mulai_program",fn:function(data){return[t._v("\n            "+t._s(data.value)+"\n          ")]}},{key:"selesai_program",fn:function(data){return[t._v("\n            "+t._s(data.value)+"\n          ")]}},{key:"created_at",fn:function(data){return[t._v("\n            "+t._s(t._f("convertDate")(data.value))+"\n          ")]}},{key:"anggaran_digunakan",fn:function(data){return[t._v("\n            RP. "+t._s(t._f("currency")(data.value))+"\n          ")]}},{key:"actions",fn:function(e){return[n("NuxtLink",{key:"edit"+e.index,staticClass:"btn btn-sm btn-outline-info mt-1",attrs:{to:"rkat/edit/"+e.item.id_rkat}},[t._v("Ubah")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-danger mt-1",on:{click:function(n){return t.destroyrkat(e.item.id_rkat)}}},[t._v("\n              Hapus\n            ")])]}}])})],1)])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-header py-3 d-flex flex-row align-items-center justify-content-between"},[n("h6",{staticClass:"m-0 font-weight-bold text-primary"},[t._v("RKAT")])])}],!1,null,null,null);e.default=component.exports}}]);